# UserCF

- 先找到相似用户，再找到他们喜欢的物品



# ItemCF

- 先找到用户喜欢的物品 再找到喜欢的物品相似的物品



# 对比

ItemCF是利用 Item之间的相似性来推荐，所以当用户数量远超Item数量时可以考虑使用ItemCF算法，因为item之间的相似性是由用户决定的

UserCF与ItemCF相反



单用户多样性方面ItemCF不如UserCF 因为是根据历史兴趣推荐

系统多样性ItemCF要好于UserCF userCF更加注重热门商品



## 计算物品相似度

** 数据整理 **

- 倒排表：  

根据基础数据整理用户-物品

| 用户 | 物品  |
| :--- | :---- |
| A    | a,c   |
| B    | a,b   |
| C    | b,c   |
| D    | a,b,c |

- 倒排表： 

根据基础数据整理成以下用户-物品倒排表

| 物品 | 用户  |
| :--- | :---- |
| a    | A,B,D |
| b    | B,C,D |
| c    | A,C,D |

** 物品相似度计算 **：
$$
w_{ij} = \frac{\sum_{u\in{N(i)\cap N(j)}}\frac{1}{\log{(1+N(u))}}}{\sqrt{|N(i)||N(j)|}}
$$


- w<sub>ij</sub>: 商品ij的相似度
- N(i): 对物品i产生过行为的用户集合
- N(j): 对物品j产生过行为的用户集合
- N(u): 用户u产生过行为的商品集合
- 分子部分 ：用户u购买的物品越多

 ** 用户对商品的喜好程度 **：
$$
p_{uj} = \sum_{i\in {S(j,k)\cap N(u)}}w_{ij}r_{ui}
$$


- S(j,k) : 与物品j相似程度最大的K个物品
- N(u) : 用户u产生过行为的物品集合
- w<sub>ij</sub> : 物品i和物品j的相似程度
- r<sub>ui</sub> : 用户u对物品i的喜好程度 （此喜好程度和$p_{ui}$的意义不同，和基于用户协同过滤中用户对物品的喜好评分一样）

$$
r_{vi} = \frac{\sum_{i\in\{op\}}M(i)W(o)}{M}T(i) 
$$




在一段时间内
- op : 用户v关于物品i的所有订单记录
- M(i) : op中每一单下单金额
- T(i) : 用户v购买物品i的次数
- W(o) : 订单类型对应的权重
- M ： 用户v总下单金额

备注：
1.针对热门商品，很多人都喜欢，诸多物品与之相似，增加惩罚力度以削弱其与其他物品的相关性。
2.活跃用户在相似度贡献上要相对小于不活跃用户，以避免物品相似度过度受活跃用户消费情况影响。